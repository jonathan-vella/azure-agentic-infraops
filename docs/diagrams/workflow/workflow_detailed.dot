
digraph DetailedWorkflow {
    graph [
        bgcolor="#1a1a2e"
        fontcolor="white"
        fontname="Segoe UI, Arial, sans-serif"
        pad="1.0"
        splines="ortho"
        nodesep="0.45"
        ranksep="1.0"
        rankdir="LR"
        dpi="150"
        newrank="true"
    ]
    
    node [
        fontname="Segoe UI, Arial, sans-serif"
        fontsize="11"
        fontcolor="white"
        style="filled,rounded"
        shape="box"
        penwidth="0"
        margin="0.25,0.15"
    ]
    
    edge [
        color="#64748b"
        fontcolor="#94a3b8"
        fontname="Segoe UI, Arial, sans-serif"
        fontsize="9"
        penwidth="2.5"
        arrowsize="0.8"
    ]

    // Step 1
    step1 [
        label="â‘  Plan\n@plan"
        fillcolor="#0078D4"
        width="1.6"
        height="0.6"
    ]

    // Step 2
    step2 [
        label="â‘¡ Architect\nazure-principal-architect"
        fillcolor="#FF6B35"
        width="2.4"
        height="0.6"
    ]

    // Step 3 - Design Artifacts
    step3 [
        label="â‘¢ Design Artifacts\n(optional)"
        fillcolor="#8b5cf6"
        width="2.0"
        height="0.6"
        style="filled,rounded,dashed"
    ]
    
    opt3a [label="ðŸ“Š -des diagram\ndiagram-generator" fillcolor="#8b5cf6" fontsize="10"]
    opt3b [label="ðŸ“ -des ADR\nadr-generator" fillcolor="#14b8a6" fontsize="10"]

    // Step 4
    step4 [
        label="â‘£ Plan Infrastructure\nbicep-plan"
        fillcolor="#10b981"
        width="2.0"
        height="0.6"
    ]
    
    opt4gov [label="ðŸ”’ Governance Discovery\nAzure Policy" fillcolor="#06b6d4" fontsize="10"]

    // Step 5
    step5 [
        label="â‘¤ Generate Code\nbicep-implement"
        fillcolor="#ec4899"
        width="2.0"
        height="0.6"
    ]

    // Step 6 - Deploy
    step6 [
        label="â‘¥ Deploy\nDeploy Agent"
        fillcolor="#f4722b"
        width="2.0"
        height="0.6"
    ]

    // Step 7 - As-Built Artifacts
    step7 [
        label="â‘¦ As-Built Artifacts\n(optional)"
        fillcolor="#f4722b"
        width="2.0"
        height="0.6"
        style="filled,rounded,dashed"
    ]
    
    opt7a [label="ðŸ“Š -ab diagram\ndiagram-generator" fillcolor="#8b5cf6" fontsize="10"]
    opt7b [label="ðŸ“ -ab ADR\nadr-generator" fillcolor="#14b8a6" fontsize="10"]

    // Main flow - thick colored arrows
    step1 -> step2 [color="#0078D4" penwidth="3"]
    step2 -> step3 [color="#FF6B35" penwidth="2" style="dashed"]
    step2 -> step4 [color="#FF6B35" penwidth="3"]
    step3 -> step4 [color="#8b5cf6" penwidth="2" style="dashed"]
    step4 -> step5 [color="#10b981" penwidth="3"]
    step5 -> step6 [color="#ec4899" penwidth="3"]
    step6 -> step7 [color="#f4722b" penwidth="2" style="dashed"]

    // Optional tools connections - above main flow
    opt3a -> step3 [style="dashed" color="#8b5cf6" arrowhead="none" arrowtail="normal" dir="back"]
    opt3b -> step3 [style="dashed" color="#14b8a6" arrowhead="none" arrowtail="normal" dir="back"]
    opt4gov -> step4 [style="dashed" color="#06b6d4" arrowhead="none" arrowtail="normal" dir="back"]
    opt7a -> step7 [style="dashed" color="#8b5cf6" arrowhead="none" arrowtail="normal" dir="back"]
    opt7b -> step7 [style="dashed" color="#14b8a6" arrowhead="none" arrowtail="normal" dir="back"]

    // Layout - optionals stacked vertically
    { rank=same; opt3a; opt3b }
    { rank=same; opt4gov }
    { rank=same; opt6a; opt6b }
    opt3a -> opt3b [style="invis" weight="10"]
    opt6a -> opt6b [style="invis" weight="10"]
}
